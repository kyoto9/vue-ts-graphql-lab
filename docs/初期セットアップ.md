# 初期セットアップ

## 目的
- リポジトリを `git clone` する前に、どのようなコマンドで雛形を作成したかを記録します。
- 同じ構成を再現したい場合の備忘録とし、テンプレート生成〜依存関係導入までを時系列でまとめます。

## 事前準備
- Node.js 20 系 / npm 10 系をインストール（Volta や nvm-windows でバージョン固定しておくと便利）。
- Git（任意: Docker Desktop 4.x 以降）。
- 作業フォルダ例: `mkdir vue-ts-graphql-lab && cd vue-ts-graphql-lab`。

## client フロントエンド雛形
1. Vite + Vue + TypeScript テンプレートを生成
   ```bash
   npm create vite@latest client -- --template vue-ts
   ```
   - 対話はスキップし、`client/` 直下にテンプレートが展開されます。
2. 依存関係の整備
   ```bash
   cd client
   npm install
   npm install @apollo/client@^3.14.0 @vue/apollo-composable@^4.2.2 graphql@^16.11.0
   npm install -D @vue/tsconfig@^0.8.1
   ```
   - GraphQL 通信用に `@apollo/client` / `@vue/apollo-composable` / `graphql` を追加。
   - Vue 公式の `@vue/tsconfig` を導入し、`tsconfig.app.json` で継承するよう調整。
3. 初期ファイル調整
   - `src/` 配下で Todo アプリ用の `graphql/` `lib/` ディレクトリを追加。
   - `tsconfig.app.json` / `tsconfig.node.json` の `strict` 系オプションを有効化。
   - `package.json` の `name` を `client` に変更し、`build` スクリプトを `vue-tsc -b && vite build` に差し替え。

## server GraphQL BFF 雛形
1. Node プロジェクトの初期化
   ```bash
   mkdir server
   cd server
   npm init -y
   npm pkg set type=module
   ```
2. 依存関係の導入
   ```bash
   npm install @apollo/server@^5.0.0 graphql@^16.11.0
   npm install -D typescript@^5.9.3 tsx@^4.20.6 ts-node@^10.9.2 @types/node@^24.7.0
   ```
   - 開発時は `tsx` で `npm run dev` を実行し、本番ビルドは `tsc` の出力を `npm run start` で起動する方針。
3. TypeScript 設定
   ```bash
   npx tsc --init --rootDir ./src --outDir ./dist --module NodeNext --moduleResolution NodeNext --target ES2022 --lib ES2022 --strict --esModuleInterop --skipLibCheck
   ```
   - 生成された `tsconfig.json` に対し、`noUncheckedIndexedAccess` / `exactOptionalPropertyTypes` / `sourceMap` / `declaration` などを追記。
4. 最小実装の追加
   - `src/index.ts` を作成し、Todo ストア（配列）と Query/Mutation の resolver を定義。
   - `package.json` に以下のスクリプトを追記。
     ```jsonc
     {
       "scripts": {
         "dev": "tsx src/index.ts",
         "build": "tsc -p tsconfig.json",
         "start": "node dist/index.js"
       }
     }
     ```

## 最後の仕上げ
- ルートに `.gitignore`、`README.md`、`compose.yaml` を作成し、必要に応じて `docs/` 配下へドキュメントを配置。
- 初期コミット前に `npm run build`（client/server）と `docker compose up --build` を試し、雛形が正常に動作することを確認。
