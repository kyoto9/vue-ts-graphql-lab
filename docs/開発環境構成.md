# 開発環境構成

## ねらい
- 新規メンバーが数分で技術選定・構成・運用ルールの全体像を掴み、手元で UI と BFF を同時に立ち上げられることを目指します。
- 詳細な手順や Docker 手順は `README.md` / `DockerDev.md` に委ね、本ドキュメントは“最初の一枚”として俯瞰情報だけを記載します。

## 技術スタック
- フロントエンド: 
  - Vue 3（Composition API 中心の UI フレームワーク）
  - TypeScript（静的型付けによる品質担保）
  - Vite（高速ビルドと開発サーバー）
  - Apollo Client（GraphQL 通信用キャッシュ付きクライアント）。
- バックエンド: 
  - Node.js 20 系（LTS ランタイム）
  - TypeScript（型安全なサーバ実装）
  - Apollo Server 5 standalone（GraphQL スキーマと resolver を即時公開できるサーバ）。
- パッケージマネージャー: 
  - npm（各パッケージ単位で依存を固定し、`package-lock.json` で整合性を維持）。

## ディレクトリ構成
```
vue-ts-graphql-lab/
├─ client/              # Vite + Vue 3 アプリ
│  ├─ src/main.ts       # エントリーポイント
│  ├─ src/App.vue       # 画面実装
│  ├─ src/lib/apollo.ts # Apollo Client 設定
│  └─ src/graphql/      # Query / Mutation 定義
├─ server/              # Apollo Server
│  └─ src/index.ts      # スキーマ + resolver
├─ docs/                # 本ドキュメントほか
└─ DockerDev.md / README.md
```

## サービス連携
- `client` がブラウザから `http://localhost:4000/graphql` に対して Query/Mutation を送信。
- `server` はメモリ上の Todo ストアを返却するシンプルな BFF。ストレージ差し替え時は resolver を分離する。
- Docker 併用時は Compose のサービス名で解決され、`web -> bff` の DNS が自動設定されます。

## 起動手順
1. 依存取得: `cd client && npm install` / `cd server && npm install`。
2. 開発サーバ: `npm run dev`（client: Vite 5173 番 / server: standalone 4000 番）。
3. ビルド確認: 各パッケージで `npm run build` を通し、`client` は `npm run preview` で本番ビルド確認。
4. コミット前にローカルで双方のサーバを停止 (`Ctrl+C`)→再起動し、GraphQL の往復が動作するか確認。

## 環境変数とポート
| 領域 | キー | 既定値 | 用途 |
| --- | --- | --- | --- |
| client | `VITE_GRAPHQL_URL` | `http://localhost:4000/graphql` | GraphQL エンドポイントの切り替え |
| server | `PORT` *(未使用)* | `4000` 固定 | 変更予定時は `startStandaloneServer` 引数を更新 |
| 共通 | `NODE_ENV` | `development` | CI/本番の挙動切り替え（将来対応） |

- `.env` / `.env.local` を利用する場合は、同名の `.env.example` を更新して共有します。

## 主要依存バージョン
| パッケージ | バージョン | 備考 |
| --- | --- | --- |
| Node.js | 20.x | Volta / nvm-windows で固定を推奨 |
| Vue | ^3.5.22 | Vite 7 系と互換 |
| Vite | ^7.1.7 | `npm run dev/build/preview` で利用 |
| TypeScript (client) | ~5.9.3 | `vue-tsc` による型チェック |
| TypeScript (server) | ^5.9.3 | `tsc` / `tsx` 実行で使用 |
| @apollo/client | ^3.14.0 | クライアント GraphQL 通信用 |
| @apollo/server | ^5.0.0 | サーバ GraphQL 実装 |
| graphql | ^16.11.0 | 共通スキーマ定義 |

- lockfile (`package-lock.json`) は双方ともコミット必須。依存更新時は PR 説明に影響範囲を記載してください。
